Training log will be saved to: /root/Perceptual-IQA-CS3324/logs/swin_multiscale_ranking_alpha0.5_20251219_211009.log
================================================================================
Random seed set to 42 for reproducibility
Training and testing on koniq-10k dataset for 10 rounds...
Using Swin Transformer backbone
KonIQ-10k: 7046 train images, 2010 test images
Round 1
  Train: 7046 images, Test: 2010 images
Using device: cuda
Backbone: Swin Transformer Tiny
Model checkpoints will be saved to: /root/Perceptual-IQA-CS3324/checkpoints/koniq-10k-swin-ranking-alpha0.5_20251219_211009
Multi-scale feature fusion: ENABLED
Regularization: drop_path_rate=0.20, dropout_rate=0.30
Loading Swin Transformer BASE (~88M parameters)
model.safetensors:   0%|          | 0.00/353M [00:00<?, ?B/s]model.safetensors:   0%|          | 0.00/353M [00:39<?, ?B/s]
Traceback (most recent call last):
  File "/root/Perceptual-IQA-CS3324/train_swin.py", line 213, in <module>
    main(config)
  File "/root/Perceptual-IQA-CS3324/train_swin.py", line 153, in main
    solver = HyperIQASolver(config, folder_path[config.dataset], train_index, test_index)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/Perceptual-IQA-CS3324/HyperIQASolver_swin.py", line 75, in __init__
    self.model_hyper = models.HyperNet(
                       ^^^^^^^^^^^^^^^^
  File "/root/Perceptual-IQA-CS3324/models_swin.py", line 38, in __init__
    self.swin = swin_backbone(lda_out_channels, target_in_size, pretrained=True, drop_path_rate=drop_path_rate, model_size=model_size)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/Perceptual-IQA-CS3324/models_swin.py", line 351, in swin_backbone
    model = SwinBackbone(lda_out_channels, in_chn, drop_path_rate=drop_path_rate, model_size=model_size)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/Perceptual-IQA-CS3324/models_swin.py", line 245, in __init__
    self.backbone = timm.create_model(
                    ^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/site-packages/timm/models/_factory.py", line 138, in create_model
    model = create_fn(
            ^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/site-packages/timm/models/swin_transformer.py", line 1152, in swin_base_patch4_window7_224
    return _create_swin_transformer(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/site-packages/timm/models/swin_transformer.py", line 1033, in _create_swin_transformer
    model = build_model_with_cfg(
            ^^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/site-packages/timm/models/_builder.py", line 457, in build_model_with_cfg
    load_pretrained(
  File "/root/miniconda3/lib/python3.12/site-packages/timm/models/_builder.py", line 226, in load_pretrained
    state_dict = load_state_dict_from_hf(pretrained_loc, weights_only=True, cache_dir=cache_dir)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/site-packages/timm/models/_hub.py", line 226, in load_state_dict_from_hf
    cached_safe_file = hf_hub_download(
                       ^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 89, in _inner_fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/site-packages/huggingface_hub/file_download.py", line 1024, in hf_hub_download
    return _hf_hub_download_to_cache_dir(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/site-packages/huggingface_hub/file_download.py", line 1240, in _hf_hub_download_to_cache_dir
    _download_to_tmp_and_move(
  File "/root/miniconda3/lib/python3.12/site-packages/huggingface_hub/file_download.py", line 1880, in _download_to_tmp_and_move
    http_get(
  File "/root/miniconda3/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 89, in _inner_fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/site-packages/huggingface_hub/file_download.py", line 454, in http_get
    for chunk in response.iter_bytes(chunk_size=constants.DOWNLOAD_CHUNK_SIZE):
  File "/root/miniconda3/lib/python3.12/site-packages/httpx/_models.py", line 897, in iter_bytes
    for raw_bytes in self.iter_raw():
  File "/root/miniconda3/lib/python3.12/site-packages/httpx/_models.py", line 951, in iter_raw
    for raw_stream_bytes in self.stream:
  File "/root/miniconda3/lib/python3.12/site-packages/httpx/_client.py", line 153, in __iter__
    for chunk in self._stream:
  File "/root/miniconda3/lib/python3.12/site-packages/httpx/_transports/default.py", line 127, in __iter__
    for part in self._httpcore_stream:
  File "/root/miniconda3/lib/python3.12/site-packages/httpcore/_sync/connection_pool.py", line 407, in __iter__
    raise exc from None
  File "/root/miniconda3/lib/python3.12/site-packages/httpcore/_sync/connection_pool.py", line 403, in __iter__
    for part in self._stream:
  File "/root/miniconda3/lib/python3.12/site-packages/httpcore/_sync/http11.py", line 342, in __iter__
    raise exc
  File "/root/miniconda3/lib/python3.12/site-packages/httpcore/_sync/http11.py", line 334, in __iter__
    for chunk in self._connection._receive_response_body(**kwargs):
  File "/root/miniconda3/lib/python3.12/site-packages/httpcore/_sync/http11.py", line 203, in _receive_response_body
    event = self._receive_event(timeout=timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/site-packages/httpcore/_sync/http11.py", line 217, in _receive_event
    data = self._network_stream.read(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/site-packages/httpcore/_backends/sync.py", line 128, in read
    return self._sock.recv(max_bytes)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/ssl.py", line 1233, in recv
    return self.read(buflen)
           ^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/ssl.py", line 1106, in read
    return self._sslobj.read(len)
           ^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
