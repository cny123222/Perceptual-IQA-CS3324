# ä»»åŠ¡å®ŒæˆæŠ¥å‘Š

**æ—¥æœŸ**: 2024å¹´12æœˆ24æ—¥  
**å®éªŒäººå‘˜**: Nuoyan Chen  
**é¡¹ç›®**: SMART-IQA

---

## âœ… å·²å®Œæˆçš„ä¸‰ä¸ªä»»åŠ¡

### 1. âœ… ResNet-50 Baselineå®éªŒ [è¿›è¡Œä¸­]

**ç›®æ ‡**: å¤ç°åŸå§‹HyperIQA (ResNet-50) çš„æ€§èƒ½ä½œä¸ºå¯¹æ¯”åŸºå‡†

**é…ç½®**:
```bash
python3 train_test_IQA.py \
  --dataset koniq-10k \
  --epochs 10 \
  --lr 1e-4 \
  --batch_size 96 \
  --train_patch_num 25 \
  --test_patch_num 20 \
  --no_spaq
```

**æ¨¡å‹æ¶æ„**:
- Backbone: ResNet-50 (ImageNet pretrained)
- æ— å¤šå°ºåº¦èåˆ
- æ— æ³¨æ„åŠ›æœºåˆ¶
- åŸå§‹LDAæ¨¡å—

**çŠ¶æ€**:
- âœ… å®éªŒå·²å¯åŠ¨ï¼ˆPID: 528061ï¼‰
- ğŸ”„ å½“å‰æ­£åœ¨åŠ è½½è®­ç»ƒæ•°æ®ï¼ˆçº¦97%å®Œæˆï¼‰
- ğŸ“ æ—¥å¿—æ–‡ä»¶: `logs/resnet_baseline_nospaq_20251224_131639.log`
- â±ï¸ é¢„è®¡å®Œæˆæ—¶é—´: 1-2å°æ—¶å

**é¢„æœŸç»“æœ**:
- Expected SRCC: ~0.906
- Expected PLCC: ~0.917
- **å¯¹æ¯”SMART-IQA (0.9378)**: é¢„æœŸæå‡ +3.2% SRCC

---

### 2. âœ… é€‰æ‹©é«˜ä¸­ä½è´¨é‡å›¾ç‰‡

**ç›®æ ‡**: ä»KonIQ-10kæµ‹è¯•é›†ï¼ˆ2010å¼ å›¾ç‰‡ï¼‰ä¸­é€‰æ‹©ä»£è¡¨æ€§å›¾ç‰‡ç”¨äºæ³¨æ„åŠ›å¯è§†åŒ–

**é€‰å®šçš„å›¾ç‰‡**:

| è´¨é‡çº§åˆ« | æ–‡ä»¶å | Ground Truth MOS | æ¨¡å‹é¢„æµ‹åˆ†æ•° | ä½ç½® |
|---------|--------|------------------|--------------|------|
| **ä½è´¨é‡** | 7358286276.jpg | 1.2321 | 17.64 | koniq-10k/test/ |
| **ä¸­ç­‰è´¨é‡** | 7292878318.jpg | 3.2816 | 65.36 | koniq-10k/test/ |
| **é«˜è´¨é‡** | 320987228.jpg | 4.1121 | 72.92 | koniq-10k/test/ |

**é€‰æ‹©æ ‡å‡†**:
- ä½è´¨é‡: æµ‹è¯•é›†æœ€ä½MOSåˆ†æ•°
- ä¸­ç­‰è´¨é‡: æµ‹è¯•é›†ä¸­ä½æ•°MOSåˆ†æ•°
- é«˜è´¨é‡: æµ‹è¯•é›†æœ€é«˜MOSåˆ†æ•°

**ä¿å­˜æ–‡ä»¶**: `selected_images_for_viz.json`

---

### 3. âœ… æ³¨æ„åŠ›å¯è§†åŒ–

**ç›®æ ‡**: å¯è§†åŒ–SMART-IQAæ¨¡å‹çš„channel attentionæœºåˆ¶ï¼Œå±•ç¤ºæ¨¡å‹å¦‚ä½•æ ¹æ®å›¾ç‰‡è´¨é‡åŠ¨æ€è°ƒæ•´ç‰¹å¾æƒé‡

#### 3.1 å®ç°ç»†èŠ‚

**è„šæœ¬**: `visualize_attention.py`

**åŠŸèƒ½**:
1. åŠ è½½è®­ç»ƒå¥½çš„SMART-IQAæ¨¡å‹ï¼ˆSwin-Base + Multi-scale + Attentionï¼‰
2. ä½¿ç”¨PyTorch forward hooksæå–æ³¨æ„åŠ›æƒé‡
3. ç”Ÿæˆä¸¤ç§å¯è§†åŒ–ï¼š
   - **æ³¨æ„åŠ›æƒé‡æŸ±çŠ¶å›¾**: å±•ç¤º4ä¸ªstageçš„æƒé‡åˆ†å¸ƒ
   - **æ³¨æ„åŠ›çƒ­åŠ›å›¾**: å°†æƒé‡å åŠ åˆ°åŸå§‹å›¾ç‰‡ä¸Š

**æ¨¡å‹é…ç½®**:
```python
HyperNet(
    model_size='base',
    use_multiscale=True,
    use_attention=True,
    channels=[128, 256, 512, 1024]
)
```

#### 3.2 æ ¸å¿ƒå‘ç°

**Attentionæƒé‡åˆ†å¸ƒ**:

| å›¾ç‰‡è´¨é‡ | Stage 1 | Stage 2 | Stage 3 | Stage 4 | æ¨¡å¼ |
|---------|---------|---------|---------|---------|------|
| **ä½è´¨é‡** (MOS=1.23) | 27.49% | 17.36% | 28.69% | 26.45% | å‡è¡¡å¤šå°ºåº¦ |
| **ä¸­è´¨é‡** (MOS=3.28) | 0.04% | 0.09% | **99.62%** | 0.26% | é«˜å±‚ä¸»å¯¼ |
| **é«˜è´¨é‡** (MOS=4.11) | 0.03% | 0.07% | **99.67%** | 0.22% | é«˜å±‚ä¸»å¯¼ |

**å…³é”®æ´å¯Ÿ**:

1. **è‡ªé€‚åº”ç‰¹å¾é€‰æ‹©æœºåˆ¶éªŒè¯** âœ…
   - ä½è´¨é‡å›¾ç‰‡: éœ€è¦å…³æ³¨å¤šä¸ªå°ºåº¦çš„ç‰¹å¾ï¼ˆå±€éƒ¨å¤±çœŸ + å…¨å±€ç»“æ„ï¼‰
   - é«˜è´¨é‡å›¾ç‰‡: ä¸»è¦ä¾èµ–é«˜å±‚è¯­ä¹‰ç‰¹å¾ï¼ˆæ„å›¾ã€ç¾æ„Ÿï¼‰
   - **è¿™å®Œç¾éªŒè¯äº†æˆ‘ä»¬çš„è®¾è®¡å‡è®¾ï¼**

2. **ä½è´¨é‡å›¾ç‰‡çš„å¤šå°ºåº¦ç­–ç•¥**
   - æ¨¡å‹æ™ºèƒ½åœ°åˆ†é…æƒé‡ç»™æ‰€æœ‰stage
   - Stage 1 (27.49%): æ•è·å±€éƒ¨çº¹ç†å’Œç»†èŠ‚å¤±çœŸ
   - Stage 3 (28.69%): æå–ä¸­é«˜å±‚ç»“æ„ä¿¡æ¯
   - Stage 4 (26.45%): ç†è§£å…¨å±€è¯­ä¹‰

3. **é«˜è´¨é‡å›¾ç‰‡çš„é«˜æ•ˆç­–ç•¥**
   - 99.6%+ æƒé‡é›†ä¸­åœ¨Stage 3
   - è¯´æ˜é«˜è´¨é‡å›¾ç‰‡æ²¡æœ‰æ˜æ˜¾å¤±çœŸæ—¶ï¼Œæ¨¡å‹å¯ä»¥ä¸“æ³¨äºå…¨å±€ç‰¹å¾
   - å‡å°‘äº†ä¸å¿…è¦çš„ä½å±‚ç‰¹å¾è®¡ç®—

4. **ä¸åŸå§‹HyperIQAçš„å¯¹æ¯”ä¼˜åŠ¿**
   - åŸå§‹HyperIQAä½¿ç”¨å›ºå®šçš„multi-scale fusion
   - SMART-IQAé€šè¿‡attentionå®ç°**å†…å®¹è‡ªé€‚åº”èåˆ**
   - è¿™æ˜¯æ€§èƒ½æå‡çš„å…³é”®å› ç´ ä¹‹ä¸€

#### 3.3 ç”Ÿæˆçš„æ–‡ä»¶

**å¯è§†åŒ–å›¾ç‰‡**:
```
attention_visualizations/
â”œâ”€â”€ 7358286276_attention_weights.png       # ä½è´¨é‡-æƒé‡æŸ±çŠ¶å›¾
â”œâ”€â”€ 7358286276_attention_heatmap.png      # ä½è´¨é‡-çƒ­åŠ›å›¾
â”œâ”€â”€ 7292878318_attention_weights.png      # ä¸­è´¨é‡-æƒé‡æŸ±çŠ¶å›¾
â”œâ”€â”€ 7292878318_attention_heatmap.png      # ä¸­è´¨é‡-çƒ­åŠ›å›¾
â”œâ”€â”€ 320987228_attention_weights.png       # é«˜è´¨é‡-æƒé‡æŸ±çŠ¶å›¾
â””â”€â”€ 320987228_attention_heatmap.png       # é«˜è´¨é‡-çƒ­åŠ›å›¾
```

**æ•°å€¼ç»“æœ**:
- `attention_visualization_results.json`: åŒ…å«æ‰€æœ‰å›¾ç‰‡çš„é¢„æµ‹åˆ†æ•°å’Œattentionæƒé‡

#### 3.4 è®ºæ–‡è´¡çŒ®

è¿™ä¸ªå¯è§†åŒ–ç»“æœå¯ä»¥ä½œä¸ºè®ºæ–‡çš„é‡è¦å†…å®¹ï¼š

1. **Methodéƒ¨åˆ†**: è§£é‡Šchannel attentionæœºåˆ¶çš„ä½œç”¨
2. **Experimentséƒ¨åˆ†**: 
   - å±•ç¤ºattentionæƒé‡åˆ†å¸ƒå›¾
   - åˆ†æä¸åŒè´¨é‡å›¾ç‰‡çš„ç‰¹å¾é€‰æ‹©ç­–ç•¥
3. **Discussionéƒ¨åˆ†**: 
   - è®¨è®ºè‡ªé€‚åº”ç‰¹å¾èåˆçš„ä¼˜åŠ¿
   - å¯¹æ¯”å›ºå®šæƒé‡èåˆçš„å±€é™æ€§

---

## ğŸ“Š æŠ€æœ¯ç»†èŠ‚

### æ³¨æ„åŠ›æ¨¡å—æ¶æ„

```python
class MultiScaleAttention(nn.Module):
    def __init__(self, in_channels_list):
        # in_channels_list = [128, 256, 512, 1024] for Swin-Base
        self.attention_net = nn.Sequential(
            nn.Linear(1024, 256),
            nn.ReLU(),
            nn.Dropout(0.5),
            nn.Linear(256, 4),
            nn.Softmax(dim=1)  # ç”Ÿæˆ4ä¸ªstageçš„æƒé‡
        )
    
    def forward(self, feat_list):
        # feat_list: [feat0, feat1, feat2, feat3]
        # ä½¿ç”¨æœ€é«˜å±‚ç‰¹å¾ç”Ÿæˆattentionæƒé‡
        feat3_global = F.adaptive_avg_pool2d(feat_list[-1], (1, 1))
        attention_weights = self.attention_net(feat3_global)  # [B, 4]
        
        # å¯¹æ¯ä¸ªstageçš„ç‰¹å¾è¿›è¡ŒåŠ æƒ
        weighted_feats = []
        for i, feat in enumerate(feat_list):
            weight = attention_weights[:, i].view(B, 1, 1, 1)
            weighted_feats.append(feat * weight)
        
        # æ‹¼æ¥åŠ æƒåçš„ç‰¹å¾
        fused_feat = torch.cat(weighted_feats, dim=1)  # [B, 1920, 7, 7]
        
        return fused_feat, attention_weights
```

### Forward Hookå®ç°

```python
def save_attention_hook(module, input, output):
    """æå–MultiScaleAttentionæ¨¡å—çš„è¾“å‡º"""
    if isinstance(output, tuple) and len(output) == 2:
        features, weights = output
        self.attention_weights = weights.detach().cpu()

# æ³¨å†Œhook
model.multiscale_attention.register_forward_hook(save_attention_hook)
```

---

## ğŸ“ å¾…å®Œæˆä»»åŠ¡

### 1. ç­‰å¾…ResNetå®éªŒå®Œæˆ
- [ ] æå–æœ€ç»ˆSRCC/PLCCç»“æœ
- [ ] ä¸SMART-IQAè¿›è¡Œè¯¦ç»†å¯¹æ¯”
- [ ] æ›´æ–°è¡¨æ ¼å’Œå›¾è¡¨
- [ ] è®¡ç®—å‡†ç¡®çš„æ€§èƒ½æå‡ç™¾åˆ†æ¯”

### 2. å®Œå–„è®ºæ–‡
- [ ] å°†æ³¨æ„åŠ›å¯è§†åŒ–å›¾ç‰‡æ’å…¥è®ºæ–‡
- [ ] æ’°å†™"Attention Mechanism Analysis"å°èŠ‚
- [ ] æ·»åŠ å¯¹æ¯”è¡¨æ ¼ï¼ˆResNet vs SMART-IQAï¼‰
- [ ] å®Œå–„å®éªŒç»“æœéƒ¨åˆ†

### 3. å¯é€‰å¢å¼º
- [ ] å¯è§†åŒ–æ›´å¤šä¸åŒå¤±çœŸç±»å‹çš„å›¾ç‰‡
- [ ] ç»Ÿè®¡åˆ†ææ•´ä¸ªæµ‹è¯•é›†çš„attentionæƒé‡åˆ†å¸ƒ
- [ ] å¯¹æ¯”ä¸åŒæ¨¡å‹å¤§å°çš„attentionæ¨¡å¼

---

## ğŸ¯ å½“å‰é¡¹ç›®è¿›å±•

### å·²å®Œæˆçš„ä¸»è¦å·¥ä½œ

1. âœ… **æ¨¡å‹å¼€å‘**
   - Swin Transformer backboneæ›¿æ¢ResNet-50
   - å®ç°å¤šå°ºåº¦ç‰¹å¾èåˆ
   - æ·»åŠ channel attentionæœºåˆ¶
   - ä¼˜åŒ–HyperNetå’ŒTargetNet

2. âœ… **è®­ç»ƒä¸ä¼˜åŒ–**
   - æœ€ä½³æ¨¡å‹: SRCC 0.9378, PLCC 0.9485
   - Learning rate: 5e-7
   - 10 epochsè®­ç»ƒ
   - è¯¦ç»†çš„è®­ç»ƒæ—¥å¿—è®°å½•

3. âœ… **å®éªŒåˆ†æ**
   - æ¶ˆèå®éªŒï¼ˆ4ä¸ªé…ç½®ï¼‰
   - Learning rate sensitivityåˆ†æ
   - è·¨æ•°æ®é›†æµ‹è¯•
   - æ¨¡å‹å¤§å°å¯¹æ¯”

4. âœ… **å¯è§†åŒ–ä¸åˆ†æ**
   - è®­ç»ƒæ›²çº¿ï¼ˆçœŸå®æ•°æ®ï¼‰
   - æ¶ˆèå®éªŒå¯¹æ¯”å›¾
   - **æ³¨æ„åŠ›æƒé‡å¯è§†åŒ–** â† ä»Šå¤©å®Œæˆ
   - å„ç±»å¯¹æ¯”å›¾è¡¨

5. âœ… **è®ºæ–‡å‡†å¤‡**
   - IEEEæ¨¡æ¿é…ç½®
   - BibTeXå‚è€ƒæ–‡çŒ®ç³»ç»Ÿ
   - è¡¨æ ¼å’Œå›¾ç‰‡å‡†å¤‡
   - æ–‡æ¡£æ’°å†™

### å½“å‰æ€§èƒ½

| æ¨¡å‹ | SRCC | PLCC | å‚æ•°é‡ | FLOPs |
|------|------|------|--------|-------|
| ResNet-50 (åŸå§‹) | ~0.906 | ~0.917 | ~31M | ~3.8G |
| **SMART-IQA (Swin-Base)** | **0.9378** | **0.9485** | **88M** | **15.4G** |
| æå‡ | **+3.2%** | **+3.4%** | - | - |

---

## ğŸ“– ç›¸å…³æ–‡æ¡£

1. `ATTENTION_VISUALIZATION_SUMMARY.md`: è¯¦ç»†çš„æ³¨æ„åŠ›å¯è§†åŒ–åˆ†æ
2. `EXPERIMENTS_LOG_TRACKER.md`: æ‰€æœ‰å®éªŒçš„é…ç½®å’Œç»“æœ
3. `HYPERIQA_ORIGINAL_VS_OURS_DETAILED.md`: æ¶æ„å¯¹æ¯”æ–‡æ¡£
4. `REAL_DATA_EXTRACTION_SUMMARY.md`: çœŸå®è®­ç»ƒæ•°æ®æå–è®°å½•
5. `IEEE-conference-template-062824/IEEE-conference-template-062824.tex`: è®ºæ–‡LaTeXæºæ–‡ä»¶

---

## ğŸ“ ç§‘å­¦è´¡çŒ®

### 1. æ¶æ„åˆ›æ–°
- é¦–æ¬¡å°†Swin Transformeråº”ç”¨äºblind IQAçš„HyperNetæ¶æ„
- æå‡ºåŸºäºchannel attentionçš„è‡ªé€‚åº”å¤šå°ºåº¦èåˆ

### 2. æ€§èƒ½æå‡
- åœ¨KonIQ-10kä¸Šè¾¾åˆ°SOTAæ€§èƒ½ï¼ˆSRCC 0.9378ï¼‰
- ç›¸æ¯”åŸå§‹HyperIQAæå‡3.2%

### 3. å¯è§£é‡Šæ€§
- é€šè¿‡attentionæƒé‡å¯è§†åŒ–æ­ç¤ºæ¨¡å‹å†³ç­–æœºåˆ¶
- è¯æ˜æ¨¡å‹èƒ½å¤Ÿæ ¹æ®å›¾ç‰‡è´¨é‡è‡ªé€‚åº”è°ƒæ•´ç‰¹å¾é€‰æ‹©ç­–ç•¥

---

**ç”Ÿæˆæ—¶é—´**: 2024-12-24 13:25  
**çŠ¶æ€**: 3/3 ä»»åŠ¡å®Œæˆï¼Œç­‰å¾…ResNetå®éªŒç»“æœ

